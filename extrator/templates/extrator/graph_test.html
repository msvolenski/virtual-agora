{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="{% static 'agora/bootstrap/docs/favicon.ico' %}">

  <title>Carousel Template for Bootstrap</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <!-- Bootstrap core CSS -->
  <link href="{% static 'agora/bootstrap/dist/css/bootstrap.min.css' %}" rel="stylesheet">

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="{% static 'agora/bootstrap/docs/assets/css/ie10-viewport-bug-workaround.css' %}" rel="stylesheet">

  <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
  <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
  <script src="{% static 'agora/bootstrap/docs/assets/js/ie-emulation-modes-warning.js' %}"></script>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src=""></script>
    <![endif]-->

  <!-- Custom styles for this template -->
  <link href="{% static 'agora/bootstrap/docs/examples/carousel/carousel.css' %}" rel="stylesheet">

  <!--script src="https://d3js.org/d3-hierarchy.v1.min.js"></script-->
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="//d3plus.org/js/d3plus.js"></script>



</head>
<!-- NAVBAR
================================================== -->

<body>

    

    
    <script>
 
      var color = d3.scale.category10();
      
      var width = 900,
          height = 500;
      
      var canvas = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height)    
      
      var ledg = d3.select("body").append("div")
            .style("position", "relative")
            .style("width", 10 + "px")
            .style("height", 10 + "px");
      
      

      d3.json("{% static 'agora/json/p5_json_temas_subtemas.json' %}", function (data) {
      
          var treemap = d3.layout.treemap()
            .size([width, height])
            .nodes(data)

          var parents = treemap.filter(function(d) {
              return d.children;}); 
          
          var cells = canvas.selectAll("g")
            .data(treemap)
            .enter()
            .append("g")
            .attr("class","cell")       
       
          
          cells.append("rect")
            .attr("x", function (d) { return d.x; })
            .attr("y", function (d) { return d.y; })
            .attr("width", function (d) { return d.dx; })
            .attr("height", function (d) { return d.dy; })
            .attr("fill", function (d) { return d.children ? null : color(d.parent.name);})
            .attr("stroke","#fff")
            .attr("ident", function (d) { return d.children ? null : d.parent.name + ' ' + d.parent.size + '%'})           
           

          cells.append("text")
            .attr("x", function (d) { return d.x + d.dx / 2 })
            .attr("y", function (d) { return d.y + d.dy / 2 })
            .attr("text-anchor", "middle")
            .text(function (d) { return d.name + "\n\r" + d.size + '%' })
          
   
            
          var i;
          parents_list = []
          for (i = 0; i < parents.length; i++) { 
              parents_list.push(parents[i].name)
          }
          
          cores_distintas = []
          cores_distintas_test = []
          d3.selectAll("rect").each(function (d){    
              var b = d3.select(this).attr("fill") 
              var a = d3.select(this).attr("ident") 
              
              if (cores_distintas_test.indexOf(b) >= 0) {
                  console.log(b)
              } else {
                  if (a){
                  var tuple = [b,a]                 
                  cores_distintas.push(tuple)
                  cores_distintas_test.push(b)
                  }
              }        
              
          }) 
          
          var legenda = d3.select("#legend")
          .selectAll('div')           
          .data(cores_distintas) 
          
          legenda.enter('div')
            .append('div') 
            .style("position", "relative")
            .style("width", 200 + "px")
            .style("height", 30 + "px")  
            .style("background", function (d) { { return d[0]} }) 
            .style("text-align", "center") 
            .style("vertical-align", "middle")
            .style("color", "black")
            .style("line-height", "30px");  
            
           
            
            
          legenda.append("text")          
            .text(function (d) { { return d[1]} })
            
          
         
      
         
          
     



      });

        
      


      
      
    </script> 

    <div id="legend">
     
    </div>



    <!-- Bootstrap core JavaScript
		================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>
      window.jQuery || document.write('<script src="{% static 'agora/ bootstrap / docs / assets / js / vendor / jquery.min.js' %}"><\/script>')
    </script>
    <script src="{% static 'agora/bootstrap/dist/js/bootstrap.min.js' %}"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
    <script src="{% static 'agora/bootstrap/docs/assets/js/vendor/holder.min.js' %}"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="{% static 'agora/bootstrap/docs/assets/js/ie10-viewport-bug-workaround.js' %}"></script>

    <script>
      $('#myModal').modal('show')
    </script>

</body>

</html>