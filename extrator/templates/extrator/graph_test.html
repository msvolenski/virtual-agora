{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">
  <style>
	
  .node {
      cursor: pointer;
  }

  .node circle {
    fill: #fff;
    stroke: steelblue;
    stroke-width: 3px;
  }

  .node text {
    font: 12px sans-serif;
  }

  .link {
    fill: none;
    stroke: #ccc;
    stroke-width: 2px;
  }  
  </style>

  <link rel="icon" href="{% static 'agora/bootstrap/docs/favicon.ico' %}">
    <!-- Bootstrap core CSS -->
  <link href="{% static 'agora/css/extrator.css' %}" rel="stylesheet">

  <title>Carousel Template for Bootstrap</title>
  <!-- <style type="text/css">
    .node {}

    .link { stroke: #999; stroke-opacity: .6; stroke-width: 1px; }
  </style> -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <!-- Bootstrap core CSS -->
  <link href="{% static 'agora/bootstrap/dist/css/bootstrap.min.css' %}" rel="stylesheet">

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="{% static 'agora/bootstrap/docs/assets/css/ie10-viewport-bug-workaround.css' %}" rel="stylesheet">

  <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
  <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
  <script src="{% static 'agora/bootstrap/docs/assets/js/ie-emulation-modes-warning.js' %}"></script>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src=""></script>
    <![endif]-->

  <!-- Custom styles for this template -->
  <link href="{% static 'agora/bootstrap/docs/examples/carousel/carousel.css' %}" rel="stylesheet">

  <!--script src="https://d3js.org/d3-hierarchy.v1.min.js"></script-->
 
 



</head>
<!-- NAVBAR
================================================== -->

<body>

<!-- load the d3.js library -->	
<script src="http://d3js.org/d3.v3.min.js"></script>
	
<script>


d3.json("{% static 'agora/json/p5_json_temas_subtemas.json' %}", function (treeData) {

    var tamanho = treeData[0].children.length
   
    // ************** Generate the tree diagram	 *****************
    var margin = {top: 20, right: 120, bottom: 20, left: 120},
        width = 960 - margin.right - margin.left,
        height = 100*tamanho - margin.top - margin.bottom;
        
    var i = 0,
        duration = 750,
        root;

    var tree = d3.layout.tree()
        .size([height, width]);

    var diagonal = d3.svg.diagonal()
        .projection(function(d) { return [d.y, d.x]; });

    var svg = d3.select("body").append("svg")
        .attr("width", width + margin.right + margin.left)
        .attr("height", height + margin.top + margin.bottom)
    .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    root = treeData[0];
    root.x0 = height / 2;
    root.y0 = 0;
    
    update(root);

    d3.select(self.frameElement).style("height", "500px");

    function update(source) {

    // Compute the new tree layout.
    var nodes = tree.nodes(root).reverse(),
        links = tree.links(nodes);

    // Normalize for fixed-depth.
    nodes.forEach(function(d) { d.y = d.depth * 180; });

    // Update the nodes…
    var node = svg.selectAll("g.node")
        .data(nodes, function(d) { return d.id || (d.id = ++i); });

    // Enter any new nodes at the parent's previous position.
    var nodeEnter = node.enter().append("g")
        .attr("class", "node")
        .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
        .on("click", click);

    nodeEnter.append("circle")
        .attr("r", 1e-6)
        .style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });

    nodeEnter.append("text")
        .attr("x", function(d) { return d.children || d._children ? -20 : 20; })
        .attr("dy", ".35em")
        .attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; })
        .text(function(d) { return d.name; })
        .style("fill-opacity", 1e-6);

    // Transition nodes to their new position.
    var nodeUpdate = node.transition()
        .duration(duration)
        .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });

    nodeUpdate.select("circle")
        .attr("r", function(d) { return d.size })
        .style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });

    nodeUpdate.select("text")
        .style("fill-opacity", 1);

    // Transition exiting nodes to the parent's new position.
    var nodeExit = node.exit().transition()
        .duration(duration)
        .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
        .remove();

    nodeExit.select("circle")
        .attr("r", 1e-6);

    nodeExit.select("text")
        .style("fill-opacity", 1e-6);

    // Update the links…
    var link = svg.selectAll("path.link")
        .data(links, function(d) { return d.target.id; });

    // Enter any new links at the parent's previous position.
    link.enter().insert("path", "g")
        .attr("class", "link")
        .attr("d", function(d) {
            var o = {x: source.x0, y: source.y0};
            return diagonal({source: o, target: o});
        });

    // Transition links to their new position.
    link.transition()
        .duration(duration)
        .attr("d", diagonal);

    // Transition exiting nodes to the parent's new position.
    link.exit().transition()
        .duration(duration)
        .attr("d", function(d) {
            var o = {x: source.x, y: source.y};
            return diagonal({source: o, target: o});
        })
        .remove();

    // Stash the old positions for transition.
    nodes.forEach(function(d) {
        d.x0 = d.x;
        d.y0 = d.y;
    });
    }

// Toggle children on click.
function click(d) {
  if (d.children) {
	d._children = d.children;
	d.children = null;
  } else {
	d.children = d._children;
	d._children = null;
  }
  update(d);
}
});
</script>






    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <!-- <svg width="960" height="600"></svg>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script>
        
        var svg = d3.select("svg"),
            width = +svg.attr("width"),
            height = +svg.attr("height");
        
        var color = d3.scaleOrdinal(d3.schemeCategory20);
        
        var simulation = d3.forceSimulation()
            .force("link", d3.forceLink().id(function(d) { return d.id; }).distance(10).strength(1))
            .force("charge", d3.forceManyBody())
            .force("center", d3.forceCenter(width / 2, height / 2));
        
              
        d3.json("{% static 'agora/json/p3_json_rede.json' %}", function(error, graph) {
          if (error) throw error;

         
          var link = svg.append("g")
              .attr("class", "links")
            .selectAll("line")      
            .data(graph.links)
            .enter().append("line")
              .attr("stroke-width", function(d) { return Math.sqrt(d.value); })        
              
          var node = svg.append("g")
              .attr("class", "nodes")
            .selectAll("circle")
            .data(graph.nodes)
            .enter().append("circle")
              .attr("r", 5)
              .attr("fill", function(d) { return color(d.group); })
              .call(d3.drag()
                  .on("start", dragstarted)
                  .on("drag", dragged)
                  .on("end", dragended));
        
          node.append("title")
              .text(function(d) { return d.id; });
        
          simulation
              .nodes(graph.nodes)
              .on("tick", ticked);
        
          simulation.force("link")
              .links(graph.links);
        
          function ticked() {
            link
                .attr("x1", function(d) { return d.source.x; })
                .attr("y1", function(d) { return d.source.y; })
                .attr("x2", function(d) { return d.target.x; })
                .attr("y2", function(d) { return d.target.y; });
        
            node
                .attr("cx", function(d) { return d.x; })
                .attr("cy", function(d) { return d.y; });

            layout
                .charge(-10 / k)
                .gravity(100 * k)
          }
        });

              
        function dragstarted(d) {
          if (!d3.event.active) simulation.alphaTarget(0.3).restart();
          d.fx = d.x;
          d.fy = d.y;
        }
        
        function dragged(d) {
          d.fx = d3.event.x;
          d.fy = d3.event.y;
        }
        
        function dragended(d) {
          if (!d3.event.active) simulation.alphaTarget(0);
          d.fx = null;
          d.fy = null;
        }

       
        
        </script>




 -->



















    <!-- <svg width="960" height="600"></svg>
    <script type="text/javascript">
        var colors = d3.scaleOrdinal(d3.schemeCategory20);
    
        var svg = d3.select("svg"),
            width = +svg.attr("width"),
            height = +svg.attr("height"),
            node,
            link;
    
        svg.append('defs').append('marker')
            .attrs({'id':'arrowhead',
                'viewBox':'-0 -5 10 10',
                'refX':13,
                'refY':0,
                'orient':'auto',
                'markerWidth':8,
                'markerHeight':8,
                'xoverflow':'visible'})
            .append('svg:path')
            .attr('d', 'M 0,-5 L 10 ,0 L 0,5')
            .attr('fill', '#999')
            .style('stroke','none');
    
        var simulation = d3.forceSimulation()
            .force("link", d3.forceLink().id(function (d) {return d.id;}).distance(50).strength(1))
            .force("charge", d3.forceManyBody())
            .force("center", d3.forceCenter(width / 2, height / 2));
    
        d3.json("{% static 'agora/json/p3_json_rede.json' %}", function (error, graph) {
            if (error) throw error;
            update(graph.links, graph.nodes);
        })
    
        function update(links, nodes) {
            link = svg.selectAll(".link")
                .data(links)
                .enter()
                .append("line")
                .attr("class", "link")
                .attr('marker-end','url(#arrowhead)')
    
            link.append("title")
                .text(function (d) {return d.type;});
    
            edgepaths = svg.selectAll(".edgepath")
                .data(links)
                .enter()
                .append('path')
                .attrs({
                    'class': 'edgepath',
                    'fill-opacity': 0,
                    'stroke-opacity': 0,
                    'id': function (d, i) {return 'edgepath' + i}
                })
                .style("pointer-events", "none");
    
            edgelabels = svg.selectAll(".edgelabel")
                .data(links)
                .enter()
                .append('text')
                .style("pointer-events", "none")
                .attrs({
                    'class': 'edgelabel',
                    'id': function (d, i) {return 'edgelabel' + i},
                    'font-size': 10,
                    'fill': '#aaa'
                });
    
            edgelabels.append('textPath')
                .attr('xlink:href', function (d, i) {return '#edgepath' + i})
                .style("text-anchor", "middle")
                .style("pointer-events", "none")
                .attr("startOffset", "50%")
                .text(function (d) {return d.type});
    
            node = svg.selectAll(".node")
                .data(nodes)
                .enter()
                .append("g")
                .attr("class", "node")
                .call(d3.drag()
                        .on("start", dragstarted)
                        .on("drag", dragged)
                        //.on("end", dragended)
                );
    
            node.append("circle")
                .attr("r", 5)
                .style("fill", function (d, i) {return colors(i);})
    
            node.append("title")
                .text(function (d) {return d.id;});
    
            node.append("text")
                .attr("dy", -3)
                .text(function (d) {return d.name;});
    
            simulation
                .nodes(nodes)
                .on("tick", ticked);
    
            simulation.force("link")
                .links(links);
        }
    
        function ticked() {
            link
                .attr("x1", function (d) {return d.source.x;})
                .attr("y1", function (d) {return d.source.y;})
                .attr("x2", function (d) {return d.target.x;})
                .attr("y2", function (d) {return d.target.y;});
    
            node
                .attr("transform", function (d) {return "translate(" + d.x + ", " + d.y + ")";});
    
            edgepaths.attr('d', function (d) {
                return 'M ' + d.source.x + ' ' + d.source.y + ' L ' + d.target.x + ' ' + d.target.y;
            });
    
            edgelabels.attr('transform', function (d) {
                if (d.target.x < d.source.x) {
                    var bbox = this.getBBox();
    
                    rx = bbox.x + bbox.width / 2;
                    ry = bbox.y + bbox.height / 2;
                    return 'rotate(180 ' + rx + ' ' + ry + ')';
                }
                else {
                    return 'rotate(0)';
                }
            });
        }
    
        function dragstarted(d) {
            if (!d3.event.active) simulation.alphaTarget(0.3).restart()
            d.fx = d.x;
            d.fy = d.y;
        }
    
        function dragged(d) {
            d.fx = d3.event.x;
            d.fy = d3.event.y;
        }
    
    //    function dragended(d) {
    //        if (!d3.event.active) simulation.alphaTarget(0);
    //        d.fx = undefined;
    //        d.fy = undefined;
    //    }
    
    </script>
    
   -->
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <!-- <h1>Force Tutorial</h1>
  <canvas id="network" width="500" height="500"></canvas> -->
  <!-- <script>
        /* global d3 */

     

        var canvas = d3.select("#network"),
            width = canvas.attr("width"),
            height = canvas.attr("height"),
            r = 3,
            color = d3.scaleOrdinal(d3.schemeCategory20);
            ctx = canvas.node().getContext("2d"),
            simulation = d3.forceSimulation()
                .force("x", d3.forceX(width/2))
                .force("y", d3.forceY(height/2))
                .force("collide", d3.forceCollide(r + 2))
                .force("charge", d3.forceManyBody()
                    .strength(-20))
                .force("link", d3.forceLink()
                    .id(function (d) { return d.name; }))
                

//        graph.nodes.forEach(function(d) {
//            d.x = Math.random() *width;
//            d.y = Math.random() *height;
 //       })  

        d3.json("{% static 'agora/json/p3_json_rede.json' %}", function (err, graph) {
            if (err) throw err;

            simulation
                .nodes(graph.nodes)
                .on("tick", update)
                .force("link")
                    .links(graph.links);
                
            canvas
                .call(d3.drag()
                    .container(canvas.node())
                    .subject(dragsubject)
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));
              

            function update() {
                ctx.clearRect(0, 0, width, height);
                
                ctx.beginPath();
                ctx.globalAlpha = 0.1;
                ctx.strokeStyle = "#aaa"
                graph.links.forEach(drawLink);
                ctx.stroke();    
                
                ctx.globalAlpha = 1.0;
                graph.nodes.forEach(drawNode);
                
            }

            function dragsubject() {
                return simulation.find(d3.event.x, d3.event.y);
            }
        });
 
        

       

        function drawNode(d) {
            ctx.beginPath();
            ctx.fillStyle = color(d.party);
            ctx.moveTo(d.x, d.y);
            ctx.arc(d.x, d.y, r, 0, 2*Math.PI);
            ctx.fill();
        }
        
        function drawLink(l) {
            ctx.moveTo(l.source.x, l.source.y);
            ctx.lineTo(l.target.x, l.target.y);
        }

        function dragstarted() {
            if (!d3.event.active) simulation.alphaTarget(0.3).restart();
            d3.event.subject.fx = d3.event.subject.x;
            d3.event.subject.fy = d3.event.subject.y;
          }
          
        function dragged() {
            d3.event.subject.fx = d3.event.x;
            d3.event.subject.fy = d3.event.y;
          }
          
        function dragended() {
            if (!d3.event.active) simulation.alphaTarget(0);
            d3.event.subject.fx = null;
            d3.event.subject.fy = null;
          }

        


  </script> -->
    



    <!-- Bootstrap core JavaScript
		================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>
      window.jQuery || document.write('<script src="{% static 'agora/ bootstrap / docs / assets / js / vendor / jquery.min.js' %}"><\/script>')
    </script>
    <script src="{% static 'agora/bootstrap/dist/js/bootstrap.min.js' %}"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
    <script src="{% static 'agora/bootstrap/docs/assets/js/vendor/holder.min.js' %}"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="{% static 'agora/bootstrap/docs/assets/js/ie10-viewport-bug-workaround.js' %}"></script>



</body>

</html>